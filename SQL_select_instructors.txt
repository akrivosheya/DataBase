WITH
   INSTRUCTORS_HIKES_COUNT AS (
        SELECT ID, COUNT(HIKE_ID) AS COUNT
           FROM (
              SELECT DISTINCT TOURISTS.ID AS ID, CONDUCTED_HIKE.ID AS HIKE_ID
                 FROM TOURISTS RIGHT OUTER JOIN CONDUCTED_HIKE ON CONDUCTED_HIKE.INSTRUCTOR = TOURISTS.ID
           )
           GROUP BY ID
    )
SELECT DISTINCT TOURISTS.NAME AS NAME, TOURISTS.LAST_NAME AS LAST_NAME, TOURISTS.SEX AS SEX, TOURISTS.BIRTH AS BIRTH, TOURISTS.CATEGORY AS CATEGORY
   FROM (((((TOURISTS RIGHT OUTER JOIN CONDUCTED_HIKE ON CONDUCTED_HIKE.INSTRUCTOR = TOURISTS.ID)
      LEFT OUTER JOIN HIKE ON HIKE.ID = CONDUCTED_HIKE.HIKE)
      LEFT OUTER JOIN ROUTE ON ROUTE.ID = HIKE.ROUTE)
      LEFT OUTER JOIN CONTAINS ON CONTAINS.ROUTE = ROUTE.ID)
      LEFT OUTER JOIN PLACE ON PLACE.ID = CONTAINS.PLACE)
      LEFT OUTER JOIN INSTRUCTORS_HIKES_COUNT ON INSTRUCTORS_HIKES_COUNT.ID = TOURISTS.ID