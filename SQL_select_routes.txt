WITH
   ROUTES_GROUPS_COUNT AS (
      SELECT ID, COUNT(GROUP_ID) AS COUNT
         FROM (
            SELECT DISTINCT ROUTE.ID AS ID, CONDUCTED_HIKE.ID AS GROUP_ID
               FROM ((ROUTE LEFT OUTER JOIN HIKE ON HIKE.ROUTE = ROUTE.ID)
                  LEFT OUTER JOIN CONDUCTED_HIKE ON CONDUCTED_HIKE.HIKE = HIKE.ID)
                  LEFT OUTER JOIN TOURISTS ON TOURISTS.ID = CONDUCTED_HIKE.INSTRUCTOR
         )
         GROUP BY ID
   )
SELECT DISTINCT ROUTE.NAME AS NAME, ROUTE.LENGTH_METRE AS LENGTH_METRE
   FROM (((((((((ROUTE LEFT OUTER JOIN CONTAINS ON ROUTE.ID = CONTAINS.ROUTE)
      LEFT OUTER JOIN PLACE ON PLACE.ID = CONTAINS.PLACE)
      LEFT OUTER JOIN HIKE ON HIKE.ROUTE = ROUTE.ID)
      LEFT OUTER JOIN CONDUCTED_HIKE ON CONDUCTED_HIKE.HIKE = HIKE.ID)
      LEFT OUTER JOIN TOURISTS ON TOURISTS.ID = CONDUCTED_HIKE.INSTRUCTOR)
      LEFT OUTER JOIN ROUTES_GROUPS_COUNT ON ROUTES_GROUPS_COUNT.ID = ROUTE.ID)
      LEFT OUTER JOIN WENT_TO_HIKE ON WENT_TO_HIKE.HIKE = HIKE.ID)
      LEFT OUTER JOIN SPORTSMEN ON SPORTSMEN.ID = WENT_TO_HIKE.TOURIST)
      LEFT OUTER JOIN GROUPS ON GROUPS.ID = SPORTSMEN.GROUP_ID)
      LEFT OUTER JOIN SECTIONS ON SECTIONS.ID = GROUPS.SECTION