WITH
   ROUTES_GROUPS_COUNT AS (
      SELECT ID, COUNT(GROUP_ID) AS COUNT
         FROM (
            SELECT DISTINCT ROUTE.ID AS ID, CONDUCTED_HIKE.ID AS GROUP_ID
               FROM ((ROUTE LEFT OUTER JOIN HIKE ON HIKE.ROUTE = ROUTE.ID)
                  LEFT OUTER JOIN CONDUCTED_HIKE ON CONDUCTED_HIKE.HIKE = HIKE.ID)
                  LEFT OUTER JOIN TOURISTS ON TOURISTS.ID = CONDUCTED_HIKE.INSTRUCTOR
         )
         GROUP BY ID
   )
SELECT DISTINCT ROUTE.NAME, ROUTE.LENGTH_METRE
   FROM (((((ROUTE LEFT OUTER JOIN CONTAINS ON ROUTE.ID = CONTAINS.ROUTE)
      LEFT OUTER JOIN PLACE ON PLACE.ID = CONTAINS.PLACE)
      LEFT OUTER JOIN HIKE ON HIKE.ROUTE = ROUTE.ID)
      LEFT OUTER JOIN CONDUCTED_HIKE ON CONDUCTED_HIKE.HIKE = HIKE.ID)
      LEFT OUTER JOIN TOURISTS ON TOURISTS.ID = CONDUCTED_HIKE.INSTRUCTOR)
      LEFT OUTER JOIN ROUTES_GROUPS_COUNT ON ROUTES_GROUPS_COUNT.ID = ROUTE.ID