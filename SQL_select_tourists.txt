WITH
    TOURISTS_ROUTES_COUNT AS (
        SELECT ID, COUNT(ROUTE_ID) AS COUNT
            FROM (
                SELECT DISTINCT TOURISTS.ID AS ID, ROUTE.ID AS ROUTE_ID
                    FROM (((((TOURISTS LEFT OUTER JOIN WENT_TO_HIKE ON TOURISTS.ID = WENT_TO_HIKE.TOURIST)
                     LEFT OUTER JOIN CONDUCTED_HIKE ON WENT_TO_HIKE.HIKE = CONDUCTED_HIKE.ID)
                      LEFT OUTER JOIN HIKE ON CONDUCTED_HIKE.HIKE = HIKE.ID)
                       LEFT OUTER JOIN ROUTE ON HIKE.ROUTE = ROUTE.ID) 
                        LEFT OUTER JOIN CONTAINS ON ROUTE.ID = CONTAINS.ROUTE)
                         LEFT OUTER JOIN PLACE ON CONTAINS.PLACE = PLACE.ID
            )
            GROUP BY ID
    ),
    TOURISTS_HIKES_COUNT AS (
        SELECT ID, COUNT(HIKE_ID) AS COUNT
            FROM (
                SELECT DISTINCT TOURISTS.ID AS ID, HIKE.ID AS HIKE_ID
                    FROM (((((TOURISTS LEFT OUTER JOIN WENT_TO_HIKE ON TOURISTS.ID = WENT_TO_HIKE.TOURIST)
                     LEFT OUTER JOIN CONDUCTED_HIKE ON WENT_TO_HIKE.HIKE = CONDUCTED_HIKE.ID)
                      LEFT OUTER JOIN HIKE ON CONDUCTED_HIKE.HIKE = HIKE.ID)
                       LEFT OUTER JOIN ROUTE ON HIKE.ROUTE = ROUTE.ID) 
                        LEFT OUTER JOIN CONTAINS ON ROUTE.ID = CONTAINS.ROUTE)
                         LEFT OUTER JOIN PLACE ON CONTAINS.PLACE = PLACE.ID
            )
            GROUP BY ID
    )
SELECT DISTINCT TOURISTS.ID, TOURISTS.NAME, TOURISTS.LAST_NAME, TOURISTS.SEX, TOURISTS.BIRTH, TOURISTS.CATEGORY, TOURISTS.TYPE
    FROM ((((((((((((TOURISTS LEFT OUTER JOIN SPORTSMEN ON TOURISTS.ID = SPORTSMEN.ID)
     LEFT OUTER JOIN GROUPS ON SPORTSMEN.GROUP_ID = GROUPS.ID) 
      LEFT OUTER JOIN TRAINS ON GROUPS.ID = TRAINS.GROUP_ID) 
       LEFT OUTER JOIN COACHES ON COACHES.ID = TRAINS.COACH)
        LEFT OUTER JOIN SECTIONS ON GROUPS.SECTION = SECTIONS.ID)
         LEFT OUTER JOIN WENT_TO_HIKE ON TOURISTS.ID = WENT_TO_HIKE.TOURIST)
          LEFT OUTER JOIN CONDUCTED_HIKE ON WENT_TO_HIKE.HIKE = CONDUCTED_HIKE.ID)
           LEFT OUTER JOIN HIKE ON CONDUCTED_HIKE.HIKE = HIKE.ID)
            LEFT OUTER JOIN ROUTE ON HIKE.ROUTE = ROUTE.ID) 
             LEFT OUTER JOIN CONTAINS ON ROUTE.ID = CONTAINS.ROUTE)
              LEFT OUTER JOIN PLACE ON CONTAINS.PLACE = PLACE.ID)
               LEFT OUTER JOIN TOURISTS_HIKES_COUNT ON TOURISTS_HIKES_COUNT.ID = TOURISTS.ID)
                LEFT OUTER JOIN TOURISTS_ROUTES_COUNT ON TOURISTS_ROUTES_COUNT.ID = TOURISTS.ID